# README
This is the README for the `tests/simulation` directory.

# Folder Structure
The relevant folder structure is as follows:

```
punchclock
    /simulation
        mc_config.py
        mc.py
        postprocess_sim_results.py
        ...
    ...
tests
    /simulation
        /data
            /mc_results
            /test_checkpoint2
            config_env.json
            config_mc.json
            simresults_df.pkl
            gen_checkpoint.py
            gen_config_env.py
            gen_simresults_df.py
            ...
        README.md
        test_mc.py
        test_mc_config.py
        test_postprocess_sim_results.py
        ...
    ...
```
# File Dependencies
## Environment Config
These tests use a common environment config, `config_env.json`.
The environment config is generated by running `gen_config_env.py`

## Postprocess Sim Results Test
The test `test_postprocess_sim_results.py` loads `simresults_df.pkl`.
To generate `simresults_df.pkl`, run `gen_simresults_df.py`. 
`gen_simresults_df.py` loads the environment config `config_env.json`.

## Ray Policy Checkpoint
A checkpoint for a Ray-generated policy is in `test_checkpoint2/`.
The files in this folder are used in the MC config test (`test_mc_config.py`).
A checkpoint can be generated by running the checkpoint generator script, `gen_checkpoint.py`.
The checkpoint generator script loads the env config file `config_env.json`.

## MC Config
The Monte Carlo config test, `test_mc_config.py`, loads the env config, `config_env.json`, the checkpoint config, `test_checkpoint2/`, and generates an MC config file, `config_mc.json`.
The MC config file `config_mc.json` has the data in the env config (also located in `config_env.json`) info embedded in it.

## MC Test
The MC test, `test_mc.py`, loads the mc config file, `config_mc.json`, and generates a directory with results in `/mc_results/exp_*`.
Each run generates a results folder `/data/mc_results/exp_*` which has .pkl files in it.
Before running `test_mc.py`, run (in order): `gen_config_env`, `gen_checkpoint`, and `test_mc_config`.

